{"title":"MS/리브레 오피스에서 삽입된 OLE 개체를 python 으로 추출","updated":"2025-11-25","content":"<article class=\"page\"><h1 id=\"page-title\">MS/리브레 오피스에서 삽입된 OLE 개체를 python 으로 추출</h1><div class=\"text-right\">Last updated: 2025-11-25</div><div class=\"markdown-body\"><h2>상황</h2>\n<p>MS 또는 리브레 오피스에는 개체삽입 기능이 있음. OLE 개체를 삽입하는 기능인데, 간단히 얘기하자면 엑셀 안에 파워포인트나 또다른 오피스 파일을 OLE 개체라는 형태로 삽입 가능함</p>\n<p>윈도우즈 전용 기능으로, 보통은 오피스 프로그램 및 Adobe Acrobat PDF 에서 이 기능을 지원함</p>\n<p>삽입된 개체는 본래의 프로그램이 설치되어 있다면, 언제든 클릭하는 것만으로 빼낼 수 있으나, 프로그램이 없는 경우 개체를 온전하게 꺼내지 못해 곤란한 경우가 가끔 있었음</p>\n<h2>조치</h2>\n<p>리브레 오피스나, MS 오피스 엑셀의 경우 확장자를 zip 으로 수정</p>\n<p>zip 파일을 열면, 리브레 오피스의 경우 보통 루트 디렉토리에, MS 오피스 엑셀의 경우 embedding 또는 이와 비슷한 이름의 디렉토리 아래에 &quot;Object&quot; 어쩌구 파일이 보이는데, 이 파일만 압축 해제</p>\n<p>&quot;Object&quot; 어쩌구 파일이 위치한 디렉토리에서 아래 python 스크립트 실행 (MS Copilot 도움을 받아 코드 생성)</p>\n<pre><code class=\"hljs language-Python\"><span class=\"hljs-keyword\">import</span> olefile\n\nf = <span class=\"hljs-string\">&quot;Ojbect 어쩌구 파일명&quot;</span>\nole = olefile.OleFileIO(f)\n\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;스트림 목록:&quot;</span>)\n<span class=\"hljs-keyword\">for</span> entry <span class=\"hljs-keyword\">in</span> ole.listdir():\n    <span class=\"hljs-built_in\">print</span>(entry)\n\n<span class=\"hljs-keyword\">if</span> ole.exists(<span class=\"hljs-string\">&#x27;Package&#x27;</span>):\n    data = ole.openstream(<span class=\"hljs-string\">&#x27;Package&#x27;</span>).read()\n    <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&quot;Package.extract.zip&quot;</span>, <span class=\"hljs-string\">&quot;wb&quot;</span>) <span class=\"hljs-keyword\">as</span> f:\n        f.write(data)\n\n<span class=\"hljs-keyword\">if</span> ole.exists(<span class=\"hljs-string\">&#x27;CONTENTS&#x27;</span>):\n    data = ole.openstream(<span class=\"hljs-string\">&#x27;CONTENTS&#x27;</span>).read()\n    <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&quot;CONTENTS.extract.zip&quot;</span>, <span class=\"hljs-string\">&quot;wb&quot;</span>) <span class=\"hljs-keyword\">as</span> f:\n        f.write(data)\n\nole.close()\n</code></pre>\n<p>만일 <code>Package</code> 형태의 OLE 개체라면 오피스 군 파일일 가능성이 크며, <code>CONTENTS</code> 형태의 OLE 개체라면 PDF 파일일 가능성이 높다.</p>\n</div></article>"}
