{"title":"MS/리브레 오피스에서 삽입된 OLE 개체를 python 으로 추출","updated":"2025-11-25","href":"/page/extract_ole_object_from_office_with_python","content":"<article class=\"page\"></article> <h1 id=\"page-title\" class=\"text-12\"></h1> <p class=\"text-right\">Last updated: </p> <h2 id=\"상황\">상황</h2>\n<p>MS 또는 리브레 오피스에는 개체삽입 기능이 있음. OLE 개체를 삽입하는 기능인데, 간단히 얘기하자면 엑셀 안에 파워포인트나 또다른 오피스 파일을 OLE 개체라는 형태로 삽입 가능함</p>\n<p>윈도우즈 전용 기능으로, 보통은 오피스 프로그램 및 Adobe Acrobat PDF 에서 이 기능을 지원함</p>\n<p>삽입된 개체는 본래의 프로그램이 설치되어 있다면, 언제든 클릭하는 것만으로 빼낼 수 있으나, 프로그램이 없는 경우 개체를 온전하게 꺼내지 못해 곤란한 경우가 가끔 있었음</p>\n<h2 id=\"조치\">조치</h2>\n<p>리브레 오피스나, MS 오피스 엑셀의 경우 확장자를 zip 으로 수정</p>\n<p>zip 파일을 열면, 리브레 오피스의 경우 보통 루트 디렉토리에, MS 오피스 엑셀의 경우 embedding 또는 이와 비슷한 이름의 디렉토리 아래에 “Object” 어쩌구 파일이 보이는데, 이 파일만 압축 해제</p>\n<p>“Object” 어쩌구 파일이 위치한 디렉토리에서 아래 python 스크립트 실행 (MS Copilot 도움을 받아 코드 생성)</p>\n<pre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> olefile</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">f </span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\"> \"Ojbect 어쩌구 파일명\"</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">ole </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> olefile.OleFileIO(f)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">print</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"스트림 목록:\"</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">for</span><span style=\"color:#E1E4E8\"> entry </span><span style=\"color:#F97583\">in</span><span style=\"color:#E1E4E8\"> ole.listdir():</span></span>\n<span class=\"line\"><span style=\"color:#79B8FF\">    print</span><span style=\"color:#E1E4E8\">(entry)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">if</span><span style=\"color:#E1E4E8\"> ole.exists(</span><span style=\"color:#9ECBFF\">'Package'</span><span style=\"color:#E1E4E8\">):</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    data </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> ole.openstream(</span><span style=\"color:#9ECBFF\">'Package'</span><span style=\"color:#E1E4E8\">).read()</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    with</span><span style=\"color:#79B8FF\"> open</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"Package.extract.zip\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"wb\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">as</span><span style=\"color:#E1E4E8\"> f:</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">        f.write(data)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">if</span><span style=\"color:#E1E4E8\"> ole.exists(</span><span style=\"color:#9ECBFF\">'CONTENTS'</span><span style=\"color:#E1E4E8\">):</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    data </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> ole.openstream(</span><span style=\"color:#9ECBFF\">'CONTENTS'</span><span style=\"color:#E1E4E8\">).read()</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    with</span><span style=\"color:#79B8FF\"> open</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">\"CONTENTS.extract.zip\"</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#9ECBFF\">\"wb\"</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">as</span><span style=\"color:#E1E4E8\"> f:</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">        f.write(data)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">ole.close()</span></span></code></pre>\n<p>만일 <code>Package</code> 형태의 OLE 개체라면 오피스 군 파일일 가능성이 크며, <code>CONTENTS</code> 형태의 OLE 개체라면 PDF 파일일 가능성이 높다.</p> ","dir":"/markdown/page/dev"}
